{
  "version": 3,
  "sources": [],
  "sections": [
    {"offset": {"line": 7, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/lib/utils.ts"],"sourcesContent":["import { clsx, type ClassValue } from \"clsx\"\nimport { twMerge } from \"tailwind-merge\"\n\nexport function cn(...inputs: ClassValue[]) {\n  return twMerge(clsx(inputs))\n}\n"],"names":[],"mappings":";;;AAAA;AACA;;;AAEO,SAAS,GAAG,GAAG,MAAoB;IACxC,OAAO,CAAA,GAAA,8JAAA,CAAA,UAAO,AAAD,EAAE,CAAA,GAAA,wIAAA,CAAA,OAAI,AAAD,EAAE;AACtB","debugId":null}},
    {"offset": {"line": 26, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/components/ui/button.tsx"],"sourcesContent":["import * as React from \"react\"\nimport { Slot } from \"@radix-ui/react-slot\"\nimport { cva, type VariantProps } from \"class-variance-authority\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst buttonVariants = cva(\n  \"inline-flex items-center justify-center gap-2 whitespace-nowrap rounded-md text-sm font-medium ring-offset-background transition-colors focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:pointer-events-none disabled:opacity-50 [&_svg]:pointer-events-none [&_svg]:size-4 [&_svg]:shrink-0\",\n  {\n    variants: {\n      variant: {\n        default: \"bg-primary text-primary-foreground hover:bg-primary/90\",\n        destructive:\n          \"bg-destructive text-destructive-foreground hover:bg-destructive/90\",\n        outline:\n          \"border border-input bg-background hover:bg-accent hover:text-accent-foreground\",\n        secondary:\n          \"bg-secondary text-secondary-foreground hover:bg-secondary/80\",\n        ghost: \"hover:bg-accent hover:text-accent-foreground\",\n        link: \"text-primary underline-offset-4 hover:underline\",\n      },\n      size: {\n        default: \"h-10 px-4 py-2\",\n        sm: \"h-9 rounded-md px-3\",\n        lg: \"h-11 rounded-md px-8\",\n        icon: \"h-10 w-10\",\n      },\n    },\n    defaultVariants: {\n      variant: \"default\",\n      size: \"default\",\n    },\n  }\n)\n\nexport interface ButtonProps\n  extends React.ButtonHTMLAttributes<HTMLButtonElement>,\n    VariantProps<typeof buttonVariants> {\n  asChild?: boolean\n}\n\nconst Button = React.forwardRef<HTMLButtonElement, ButtonProps>(\n  ({ className, variant, size, asChild = false, ...props }, ref) => {\n    const Comp = asChild ? Slot : \"button\"\n    return (\n      <Comp\n        className={cn(buttonVariants({ variant, size, className }))}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nButton.displayName = \"Button\"\n\nexport { Button, buttonVariants }\n"],"names":[],"mappings":";;;;;AAAA;AACA;AACA;AAEA;;;;;;AAEA,MAAM,iBAAiB,CAAA,GAAA,mKAAA,CAAA,MAAG,AAAD,EACvB,4VACA;IACE,UAAU;QACR,SAAS;YACP,SAAS;YACT,aACE;YACF,SACE;YACF,WACE;YACF,OAAO;YACP,MAAM;QACR;QACA,MAAM;YACJ,SAAS;YACT,IAAI;YACJ,IAAI;YACJ,MAAM;QACR;IACF;IACA,iBAAiB;QACf,SAAS;QACT,MAAM;IACR;AACF;AASF,MAAM,uBAAS,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC5B,CAAC,EAAE,SAAS,EAAE,OAAO,EAAE,IAAI,EAAE,UAAU,KAAK,EAAE,GAAG,OAAO,EAAE;IACxD,MAAM,OAAO,UAAU,mKAAA,CAAA,OAAI,GAAG;IAC9B,qBACE,6LAAC;QACC,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,eAAe;YAAE;YAAS;YAAM;QAAU;QACxD,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,OAAO,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 93, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/components/ui/card.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Card = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"rounded-lg border bg-card text-card-foreground shadow-sm\",\n      className\n    )}\n    {...props}\n  />\n))\nCard.displayName = \"Card\"\n\nconst CardHeader = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex flex-col space-y-1.5 p-6\", className)}\n    {...props}\n  />\n))\nCardHeader.displayName = \"CardHeader\"\n\nconst CardTitle = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\n      \"text-2xl font-semibold leading-none tracking-tight\",\n      className\n    )}\n    {...props}\n  />\n))\nCardTitle.displayName = \"CardTitle\"\n\nconst CardDescription = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"text-sm text-muted-foreground\", className)}\n    {...props}\n  />\n))\nCardDescription.displayName = \"CardDescription\"\n\nconst CardContent = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div ref={ref} className={cn(\"p-6 pt-0\", className)} {...props} />\n))\nCardContent.displayName = \"CardContent\"\n\nconst CardFooter = React.forwardRef<\n  HTMLDivElement,\n  React.HTMLAttributes<HTMLDivElement>\n>(({ className, ...props }, ref) => (\n  <div\n    ref={ref}\n    className={cn(\"flex items-center p-6 pt-0\", className)}\n    {...props}\n  />\n))\nCardFooter.displayName = \"CardFooter\"\n\nexport { Card, CardHeader, CardFooter, CardTitle, CardDescription, CardContent }\n"],"names":[],"mappings":";;;;;;;;;AAAA;AAEA;;;;AAEA,MAAM,qBAAO,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAG1B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,4DACA;QAED,GAAG,KAAK;;;;;;;AAGb,KAAK,WAAW,GAAG;AAEnB,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG;AAEzB,MAAM,0BAAY,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAG/B,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,sDACA;QAED,GAAG,KAAK;;;;;;;AAGb,UAAU,WAAW,GAAG;AAExB,MAAM,gCAAkB,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGrC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,iCAAiC;QAC9C,GAAG,KAAK;;;;;;;AAGb,gBAAgB,WAAW,GAAG;AAE9B,MAAM,4BAAc,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,QAGjC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QAAI,KAAK;QAAK,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,YAAY;QAAa,GAAG,KAAK;;;;;;;AAEhE,YAAY,WAAW,GAAG;AAE1B,MAAM,2BAAa,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,SAGhC,CAAC,EAAE,SAAS,EAAE,GAAG,OAAO,EAAE,oBAC1B,6LAAC;QACC,KAAK;QACL,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EAAE,8BAA8B;QAC3C,GAAG,KAAK;;;;;;;AAGb,WAAW,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 196, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/components/ui/input.tsx"],"sourcesContent":["import * as React from \"react\"\n\nimport { cn } from \"@/lib/utils\"\n\nconst Input = React.forwardRef<HTMLInputElement, React.ComponentProps<\"input\">>(\n  ({ className, type, ...props }, ref) => {\n    return (\n      <input\n        type={type}\n        className={cn(\n          \"flex h-10 w-full rounded-md border border-input bg-background px-3 py-2 text-base ring-offset-background file:border-0 file:bg-transparent file:text-sm file:font-medium file:text-foreground placeholder:text-muted-foreground focus-visible:outline-none focus-visible:ring-2 focus-visible:ring-ring focus-visible:ring-offset-2 disabled:cursor-not-allowed disabled:opacity-50 md:text-sm\",\n          className\n        )}\n        ref={ref}\n        {...props}\n      />\n    )\n  }\n)\nInput.displayName = \"Input\"\n\nexport { Input }\n"],"names":[],"mappings":";;;;AAAA;AAEA;;;;AAEA,MAAM,sBAAQ,CAAA,GAAA,6JAAA,CAAA,aAAgB,AAAD,OAC3B,CAAC,EAAE,SAAS,EAAE,IAAI,EAAE,GAAG,OAAO,EAAE;IAC9B,qBACE,6LAAC;QACC,MAAM;QACN,WAAW,CAAA,GAAA,+GAAA,CAAA,KAAE,AAAD,EACV,kYACA;QAEF,KAAK;QACJ,GAAG,KAAK;;;;;;AAGf;;AAEF,MAAM,WAAW,GAAG","debugId":null}},
    {"offset": {"line": 232, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/lib/socket.ts"],"sourcesContent":["\"use client\";\r\n\r\nimport { io, Socket } from \"socket.io-client\";\r\n\r\n// Force production URL since the backend is deployed\r\nconst BACKEND_URL = 'https://arleen-credit-repair-backend.onrender.com';\r\n\r\nclass SocketService {\r\n  private socket: Socket | null = null;\r\n  private static instance: SocketService;\r\n\r\n  public static getInstance(): SocketService {\r\n    if (!SocketService.instance) {\r\n      SocketService.instance = new SocketService();\r\n    }\r\n    return SocketService.instance;\r\n  }\r\n\r\n  public connect(token?: string): Socket {\r\n    if (!this.socket) {\r\n      this.socket = io(BACKEND_URL, {\r\n        withCredentials: true,\r\n        transports: ['websocket', 'polling'],\r\n        auth: {\r\n          token: token\r\n        }\r\n      });\r\n\r\n      this.socket.on('connect', () => {\r\n        console.log('Connected to server');\r\n      });\r\n\r\n      this.socket.on('disconnect', () => {\r\n        console.log('Disconnected from server');\r\n      });\r\n\r\n      this.socket.on('connect_error', (error) => {\r\n        console.error('Connection error:', error);\r\n      });\r\n    }\r\n    return this.socket;\r\n  }\r\n\r\n  public disconnect(): void {\r\n    if (this.socket) {\r\n      this.socket.disconnect();\r\n      this.socket = null;\r\n    }\r\n  }\r\n\r\n  public getSocket(): Socket | null {\r\n    return this.socket;\r\n  }\r\n\r\n  // Chat-specific methods\r\n  public joinChat(chatId: string, userType: 'user' | 'agent'): void {\r\n    if (this.socket) {\r\n      this.socket.emit('join_chat', { chatId, userType });\r\n    }\r\n  }\r\n\r\n  public leaveChat(chatId: string, userType: 'user' | 'agent'): void {\r\n    if (this.socket) {\r\n      this.socket.emit('leave_chat', { chatId, userType });\r\n    }\r\n  }\r\n\r\n  public sendMessage(data: {\r\n    chatId: string;\r\n    text: string;\r\n    sender: 'user' | 'agent';\r\n    senderName: string;\r\n  }): void {\r\n    if (this.socket) {\r\n      this.socket.emit('send_message', data);\r\n    }\r\n  }\r\n\r\n  public startTyping(chatId: string, userType: 'user' | 'agent'): void {\r\n    if (this.socket) {\r\n      this.socket.emit('typing_start', { chatId, userType });\r\n    }\r\n  }\r\n\r\n  public stopTyping(chatId: string, userType: 'user' | 'agent'): void {\r\n    if (this.socket) {\r\n      this.socket.emit('typing_stop', { chatId, userType });\r\n    }\r\n  }\r\n}\r\n\r\nexport default SocketService;\r\n"],"names":[],"mappings":";;;AAEA;AAAA;AAFA;;AAIA,qDAAqD;AACrD,MAAM,cAAc;AAEpB,MAAM;IACI,SAAwB,KAAK;IACrC,OAAe,SAAwB;IAEvC,OAAc,cAA6B;QACzC,IAAI,CAAC,cAAc,QAAQ,EAAE;YAC3B,cAAc,QAAQ,GAAG,IAAI;QAC/B;QACA,OAAO,cAAc,QAAQ;IAC/B;IAEO,QAAQ,KAAc,EAAU;QACrC,IAAI,CAAC,IAAI,CAAC,MAAM,EAAE;YAChB,IAAI,CAAC,MAAM,GAAG,CAAA,GAAA,kLAAA,CAAA,KAAE,AAAD,EAAE,aAAa;gBAC5B,iBAAiB;gBACjB,YAAY;oBAAC;oBAAa;iBAAU;gBACpC,MAAM;oBACJ,OAAO;gBACT;YACF;YAEA,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,WAAW;gBACxB,QAAQ,GAAG,CAAC;YACd;YAEA,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,cAAc;gBAC3B,QAAQ,GAAG,CAAC;YACd;YAEA,IAAI,CAAC,MAAM,CAAC,EAAE,CAAC,iBAAiB,CAAC;gBAC/B,QAAQ,KAAK,CAAC,qBAAqB;YACrC;QACF;QACA,OAAO,IAAI,CAAC,MAAM;IACpB;IAEO,aAAmB;QACxB,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,UAAU;YACtB,IAAI,CAAC,MAAM,GAAG;QAChB;IACF;IAEO,YAA2B;QAChC,OAAO,IAAI,CAAC,MAAM;IACpB;IAEA,wBAAwB;IACjB,SAAS,MAAc,EAAE,QAA0B,EAAQ;QAChE,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,aAAa;gBAAE;gBAAQ;YAAS;QACnD;IACF;IAEO,UAAU,MAAc,EAAE,QAA0B,EAAQ;QACjE,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,cAAc;gBAAE;gBAAQ;YAAS;QACpD;IACF;IAEO,YAAY,IAKlB,EAAQ;QACP,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB;QACnC;IACF;IAEO,YAAY,MAAc,EAAE,QAA0B,EAAQ;QACnE,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,gBAAgB;gBAAE;gBAAQ;YAAS;QACtD;IACF;IAEO,WAAW,MAAc,EAAE,QAA0B,EAAQ;QAClE,IAAI,IAAI,CAAC,MAAM,EAAE;YACf,IAAI,CAAC,MAAM,CAAC,IAAI,CAAC,eAAe;gBAAE;gBAAQ;YAAS;QACrD;IACF;AACF;uCAEe","debugId":null}},
    {"offset": {"line": 332, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/lib/auth-utils.ts"],"sourcesContent":["import { jwtDecode } from \"jwt-decode\";\r\n\r\nexport interface DecodedToken {\r\n  id: string;\r\n  userId: string;\r\n  email: string;\r\n  userEmail: string;\r\n  userName: string;\r\n  firstName?: string;\r\n  username?: string;\r\n  iat?: number;\r\n  exp?: number;\r\n}\r\n\r\nexport interface TokenValidationResult {\r\n  isValid: boolean;\r\n  email?: string;\r\n  userName?: string;\r\n  error?: string;\r\n  debugInfo?: any;\r\n}\r\n\r\n/**\r\n * Validates and extracts user information from JWT token\r\n * Now handles legacy tokens and provides fallback authentication\r\n */\r\nexport function validateToken(token: string): TokenValidationResult {\r\n  try {\r\n    if (!token) {\r\n      return {\r\n        isValid: false,\r\n        error: \"No token provided\"\r\n      };\r\n    }\r\n\r\n    const decoded = jwtDecode<DecodedToken>(token);\r\n    \r\n    // Check if token is expired first\r\n    if (decoded.exp && decoded.exp < Date.now() / 1000) {\r\n      return {\r\n        isValid: false,\r\n        error: \"Token has expired. Please login again.\"\r\n      };\r\n    }\r\n    \r\n    // Extract email with fallbacks\r\n    const email = decoded.email || decoded.userEmail;\r\n    \r\n    // Extract userName with fallbacks\r\n    const userName = decoded.userName || decoded.username || decoded.firstName;\r\n    \r\n    const debugInfo = {\r\n      tokenKeys: Object.keys(decoded),\r\n      tokenFields: {\r\n        hasId: !!decoded.id,\r\n        hasUserId: !!decoded.userId,\r\n        hasEmail: !!decoded.email,\r\n        hasUserEmail: !!decoded.userEmail,\r\n        hasUserName: !!decoded.userName,\r\n        hasUsername: !!decoded.username,\r\n        hasFirstName: !!decoded.firstName\r\n      },\r\n      extractedValues: {\r\n        email: {\r\n          value: email,\r\n          source: decoded.email ? 'email' : (decoded.userEmail ? 'userEmail' : 'none')\r\n        },\r\n        userName: {\r\n          value: userName,\r\n          source: decoded.userName ? 'userName' : (decoded.username ? 'username' : (decoded.firstName ? 'firstName' : 'none'))\r\n        }\r\n      },\r\n      rawDecoded: decoded,\r\n      isLegacyToken: !email || !userName\r\n    };\r\n\r\n    // Handle legacy tokens from older backend versions\r\n    if (!email || !userName) {\r\n      // Check if we have user data in localStorage as fallback\r\n      const storedUser = localStorage.getItem('user');\r\n      if (storedUser) {\r\n        try {\r\n          const userData = JSON.parse(storedUser);\r\n          const fallbackEmail = email || userData.email;\r\n          const fallbackUserName = userName || userData.username || userData.firstName || userData.name;\r\n          \r\n          if (fallbackEmail && fallbackUserName) {\r\n            console.warn('Using fallback user data from localStorage for legacy token');\r\n            return {\r\n              isValid: true,\r\n              email: fallbackEmail,\r\n              userName: fallbackUserName,\r\n              debugInfo: {\r\n                ...debugInfo,\r\n                usedFallback: true,\r\n                fallbackSource: 'localStorage'\r\n              }\r\n            };\r\n          }\r\n        } catch (e) {\r\n          console.error('Failed to parse stored user data:', e);\r\n        }\r\n      }\r\n      \r\n      // If no fallback available, return error with helpful message\r\n      const missingFields = [];\r\n      if (!email) missingFields.push('email');\r\n      if (!userName) missingFields.push('userName');\r\n      \r\n      return {\r\n        isValid: false,\r\n        error: `Your session is using an older token format. Please log out and log in again to update your authentication.`,\r\n        debugInfo\r\n      };\r\n    }\r\n\r\n    return {\r\n      isValid: true,\r\n      email,\r\n      userName,\r\n      debugInfo\r\n    };\r\n\r\n  } catch (error) {\r\n    return {\r\n      isValid: false,\r\n      error: `Token decode error: ${error instanceof Error ? error.message : 'Unknown error'}`\r\n    };\r\n  }\r\n}\r\n\r\n/**\r\n * Checks if token is expired\r\n */\r\nexport function isTokenExpired(token: string): boolean {\r\n  try {\r\n    const decoded = jwtDecode<DecodedToken>(token);\r\n    if (!decoded.exp) return false;\r\n    \r\n    const currentTime = Date.now() / 1000;\r\n    return decoded.exp < currentTime;\r\n  } catch {\r\n    return true;\r\n  }\r\n}\r\n\r\n/**\r\n * Gets token from localStorage with validation\r\n */\r\nexport function getValidatedToken(): TokenValidationResult {\r\n  const token = localStorage.getItem('token');\r\n  \r\n  if (!token) {\r\n    return {\r\n      isValid: false,\r\n      error: \"No token found in localStorage\"\r\n    };\r\n  }\r\n\r\n  if (isTokenExpired(token)) {\r\n    return {\r\n      isValid: false,\r\n      error: \"Token has expired\"\r\n    };\r\n  }\r\n\r\n  return validateToken(token);\r\n}\r\n"],"names":[],"mappings":";;;;;AAAA;;AA0BO,SAAS,cAAc,KAAa;IACzC,IAAI;QACF,IAAI,CAAC,OAAO;YACV,OAAO;gBACL,SAAS;gBACT,OAAO;YACT;QACF;QAEA,MAAM,UAAU,CAAA,GAAA,yJAAA,CAAA,YAAS,AAAD,EAAgB;QAExC,kCAAkC;QAClC,IAAI,QAAQ,GAAG,IAAI,QAAQ,GAAG,GAAG,KAAK,GAAG,KAAK,MAAM;YAClD,OAAO;gBACL,SAAS;gBACT,OAAO;YACT;QACF;QAEA,+BAA+B;QAC/B,MAAM,QAAQ,QAAQ,KAAK,IAAI,QAAQ,SAAS;QAEhD,kCAAkC;QAClC,MAAM,WAAW,QAAQ,QAAQ,IAAI,QAAQ,QAAQ,IAAI,QAAQ,SAAS;QAE1E,MAAM,YAAY;YAChB,WAAW,OAAO,IAAI,CAAC;YACvB,aAAa;gBACX,OAAO,CAAC,CAAC,QAAQ,EAAE;gBACnB,WAAW,CAAC,CAAC,QAAQ,MAAM;gBAC3B,UAAU,CAAC,CAAC,QAAQ,KAAK;gBACzB,cAAc,CAAC,CAAC,QAAQ,SAAS;gBACjC,aAAa,CAAC,CAAC,QAAQ,QAAQ;gBAC/B,aAAa,CAAC,CAAC,QAAQ,QAAQ;gBAC/B,cAAc,CAAC,CAAC,QAAQ,SAAS;YACnC;YACA,iBAAiB;gBACf,OAAO;oBACL,OAAO;oBACP,QAAQ,QAAQ,KAAK,GAAG,UAAW,QAAQ,SAAS,GAAG,cAAc;gBACvE;gBACA,UAAU;oBACR,OAAO;oBACP,QAAQ,QAAQ,QAAQ,GAAG,aAAc,QAAQ,QAAQ,GAAG,aAAc,QAAQ,SAAS,GAAG,cAAc;gBAC9G;YACF;YACA,YAAY;YACZ,eAAe,CAAC,SAAS,CAAC;QAC5B;QAEA,mDAAmD;QACnD,IAAI,CAAC,SAAS,CAAC,UAAU;YACvB,yDAAyD;YACzD,MAAM,aAAa,aAAa,OAAO,CAAC;YACxC,IAAI,YAAY;gBACd,IAAI;oBACF,MAAM,WAAW,KAAK,KAAK,CAAC;oBAC5B,MAAM,gBAAgB,SAAS,SAAS,KAAK;oBAC7C,MAAM,mBAAmB,YAAY,SAAS,QAAQ,IAAI,SAAS,SAAS,IAAI,SAAS,IAAI;oBAE7F,IAAI,iBAAiB,kBAAkB;wBACrC,QAAQ,IAAI,CAAC;wBACb,OAAO;4BACL,SAAS;4BACT,OAAO;4BACP,UAAU;4BACV,WAAW;gCACT,GAAG,SAAS;gCACZ,cAAc;gCACd,gBAAgB;4BAClB;wBACF;oBACF;gBACF,EAAE,OAAO,GAAG;oBACV,QAAQ,KAAK,CAAC,qCAAqC;gBACrD;YACF;YAEA,8DAA8D;YAC9D,MAAM,gBAAgB,EAAE;YACxB,IAAI,CAAC,OAAO,cAAc,IAAI,CAAC;YAC/B,IAAI,CAAC,UAAU,cAAc,IAAI,CAAC;YAElC,OAAO;gBACL,SAAS;gBACT,OAAO,CAAC,2GAA2G,CAAC;gBACpH;YACF;QACF;QAEA,OAAO;YACL,SAAS;YACT;YACA;YACA;QACF;IAEF,EAAE,OAAO,OAAO;QACd,OAAO;YACL,SAAS;YACT,OAAO,CAAC,oBAAoB,EAAE,iBAAiB,QAAQ,MAAM,OAAO,GAAG,iBAAiB;QAC1F;IACF;AACF;AAKO,SAAS,eAAe,KAAa;IAC1C,IAAI;QACF,MAAM,UAAU,CAAA,GAAA,yJAAA,CAAA,YAAS,AAAD,EAAgB;QACxC,IAAI,CAAC,QAAQ,GAAG,EAAE,OAAO;QAEzB,MAAM,cAAc,KAAK,GAAG,KAAK;QACjC,OAAO,QAAQ,GAAG,GAAG;IACvB,EAAE,OAAM;QACN,OAAO;IACT;AACF;AAKO,SAAS;IACd,MAAM,QAAQ,aAAa,OAAO,CAAC;IAEnC,IAAI,CAAC,OAAO;QACV,OAAO;YACL,SAAS;YACT,OAAO;QACT;IACF;IAEA,IAAI,eAAe,QAAQ;QACzB,OAAO;YACL,SAAS;YACT,OAAO;QACT;IACF;IAEA,OAAO,cAAc;AACvB","debugId":null}},
    {"offset": {"line": 467, "column": 0}, "map": {"version":3,"sources":["file://C%3A/Users/jesam/OneDrive/Documents/arleen-credit-main/acr/client/app/chat/page.tsx"],"sourcesContent":["\"use client\";\n\nimport type React from \"react\";\nimport { useEffect, useState, useRef } from \"react\";\nimport { Button } from \"@/components/ui/button\";\nimport { Card, CardContent, CardHeader, CardTitle } from \"@/components/ui/card\";\nimport { Input } from \"@/components/ui/input\";\nimport { useRouter } from \"next/navigation\";\nimport { Send, ArrowLeft, User, Bot, Wifi, WifiOff, ChevronDown, ChevronUp } from \"lucide-react\";\nimport Link from \"next/link\";\nimport SocketService from \"@/lib/socket\";\nimport { jwtDecode } from \"jwt-decode\";\nimport { validateToken } from \"@/lib/auth-utils\";\n\ninterface Message {\n  _id?: string;\n  text: string;\n  sender: \"user\" | \"agent\";\n  timestamp: Date;\n}\n\ninterface ChatData {\n  chatId: string;\n  messages: Message[];\n  selectedPlan?: any;\n  status: string;\n}\n\ninterface DecodedToken {\n  id: string;\n  email: string;\n  name: string;\n}\n\n\nexport default function ChatPage() {\n  const [isAuthenticated, setIsAuthenticated] = useState(false);\n  const [selectedPlan, setSelectedPlan] = useState<any>(null);\n  const [messages, setMessages] = useState<Message[]>([]);\n  const [newMessage, setNewMessage] = useState(\"\");\n  const [isTyping, setIsTyping] = useState(false);\n  const [agentTyping, setAgentTyping] = useState(false);\n  const [isConnected, setIsConnected] = useState(false);\n  const [agentOnline, setAgentOnline] = useState(false);\n  const [chatId, setChatId] = useState<string | null>(null);\n  const [userName, setUserName] = useState(\"\");\n  const [userEmail, setUserEmail] = useState(\"\");\n  const [showPlanDetails, setShowPlanDetails] = useState(false);\n  const router = useRouter();\n  const chatEndRef = useRef<HTMLDivElement>(null);\n  const messagesContainerRef = useRef<HTMLDivElement>(null);\n  const socketService = SocketService.getInstance();\n  const typingTimeoutRef = useRef<NodeJS.Timeout | null>(null);\n\n  // Initialize chat and Socket.IO connection\n  useEffect(() => {\n    const initChat = async () => {\n      const token = localStorage.getItem(\"token\");\n      if (!token) {\n        router.push(\"/login\");\n        return;\n      }\n\n      setIsAuthenticated(true);\n\n      try {\n        console.log(\"Raw token from localStorage:\", token);\n\n        const decoded: DecodedToken = jwtDecode<DecodedToken>(token);\n\n        // Debug logging to check JWT contents\n        console.log(\"JWT Token decoded - FULL OBJECT:\", decoded);\n        console.log(\"JWT Token keys:\", Object.keys(decoded));\n        console.log(\"JWT Token values:\", Object.values(decoded));\n\n        // Use improved validation with fallback support\n        const validation = validateToken(token);\n        \n        if (!validation.isValid) {\n          console.error(\"Token validation failed:\", {\n            error: validation.error,\n            debugInfo: validation.debugInfo\n          });\n          \n          // Show user-friendly error message\n          const errorMessage = validation.error || 'Authentication failed';\n          alert(errorMessage);\n          \n          // Clear invalid token and redirect\n          localStorage.removeItem('token');\n          localStorage.removeItem('user');\n          router.push(\"/login\");\n          return;\n        }\n        \n        // Extract validated email and userName\n        const email = validation.email!;\n        const userName = validation.userName!;\n        \n        // Log if we used fallback data\n        if (validation.debugInfo?.usedFallback) {\n          console.warn('Authentication using fallback data from localStorage');\n        }\n\n        // Set email and username\n        setUserEmail(email);\n        setUserName(userName);\n\n        const plan = localStorage.getItem(\"selectedPlan\");\n        if (plan) {\n          setSelectedPlan(JSON.parse(plan));\n        }\n\n        const socket = socketService.connect(token);\n\n        socket.on(\"connect\", () => {\n          setIsConnected(true);\n          console.log(\"Connected to chat server\");\n        });\n\n        socket.on(\"disconnect\", () => {\n          setIsConnected(false);\n          setAgentOnline(false);\n          console.log(\"Disconnected from chat server\");\n        });\n\n        socket.on(\"connect_error\", (error) => {\n          console.error(\"Socket connection error:\", error);\n          if (\n            error.message === \"Authentication required\" ||\n            error.message === \"Invalid token\"\n          ) {\n            router.push(\"/login\");\n          }\n        });\n\n        const requestBody = {\n          userEmail: email,\n          userName: userName,\n          selectedPlan: plan ? JSON.parse(plan) : null,\n        };\n\n        console.log(\"Chat API request body:\", requestBody);\n\n        const response = await fetch(\n          \"https://arleen-credit-repair-backend.onrender.com/chat/create\",\n          {\n            method: \"POST\",\n            headers: {\n              \"Content-Type\": \"application/json\",\n              Authorization: `Bearer ${token}`,\n            },\n            body: JSON.stringify(requestBody),\n          }\n        );\n\n        const data = await response.json();\n        console.log(\"Chat API response:\", { status: response.status, data });\n\n        if (response.ok && data.success) {\n          const chat = data.chat;\n          setChatId(chat.chatId);\n          setMessages(\n            chat.messages.map((msg: any) => ({\n              ...msg,\n              timestamp: new Date(msg.timestamp),\n            }))\n          );\n\n          socketService.joinChat(chat.chatId, \"user\");\n        } else {\n          const errorMessage =\n            data.message || data.msg || data.error || \"Unknown error\";\n          console.error(\"Failed to create/get chat:\", {\n            status: response.status,\n            errorMessage,\n            fullResponse: data,\n            requestBody\n          });\n          \n          // Show user-friendly error message\n          alert(`Chat Error: ${errorMessage}\\n\\nPlease try logging out and logging in again.`);\n          \n          if (errorMessage.includes(\"Authentication\") || errorMessage.includes(\"token\")) {\n            // Clear authentication and redirect\n            localStorage.removeItem('token');\n            localStorage.removeItem('user');\n            router.push(\"/login\");\n          }\n        }\n\n        socket.on(\"receive_message\", (message) => {\n          setMessages((prev) => [\n            ...prev,\n            {\n              ...message,\n              timestamp: new Date(message.timestamp),\n            },\n          ]);\n        });\n\n        socket.on(\"user_typing\", (data) => {\n          if (data.userType === \"agent\") {\n            setAgentTyping(data.isTyping);\n          }\n        });\n\n        socket.on(\"agent_status\", (data) => {\n          setAgentOnline(data.isOnline);\n        });\n      } catch (error) {\n        console.error(\"Error decoding token or initializing chat:\", error);\n        router.push(\"/login\");\n      }\n    };\n\n    initChat();\n  }, []);\n\n  useEffect(() => {\n    // Auto-scroll to bottom when new messages arrive\n    if (messagesContainerRef.current) {\n      messagesContainerRef.current.scrollTop =\n        messagesContainerRef.current.scrollHeight;\n    }\n  }, [messages, isTyping]);\n\n  const handleSendMessage = async () => {\n    if (!newMessage.trim() || !chatId) return;\n\n    const messageText = newMessage;\n    setNewMessage(\"\");\n\n    // Stop typing indicator\n    socketService.stopTyping(chatId, \"user\");\n\n    // Send message via Socket.IO\n    socketService.sendMessage({\n      chatId,\n      text: messageText,\n      sender: \"user\",\n      senderName: userName,\n    });\n  };\n\n  const handleInputChange = (e: React.ChangeEvent<HTMLInputElement>) => {\n    setNewMessage(e.target.value);\n\n    if (chatId && e.target.value.trim()) {\n      // Start typing indicator\n      socketService.startTyping(chatId, \"user\");\n\n      // Clear previous timeout\n      if (typingTimeoutRef.current) {\n        clearTimeout(typingTimeoutRef.current);\n      }\n\n      // Stop typing after 3 seconds of inactivity\n      typingTimeoutRef.current = setTimeout(() => {\n        socketService.stopTyping(chatId, \"user\");\n      }, 3000);\n    } else if (chatId) {\n      socketService.stopTyping(chatId, \"user\");\n    }\n  };\n\n  const generateAgentResponse = (userMessage: string, plan: any) => {\n    const message = userMessage.toLowerCase();\n\n    if (\n      message.includes(\"price\") ||\n      message.includes(\"cost\") ||\n      message.includes(\"payment\")\n    ) {\n      if (plan) {\n        if (plan.isPaymentPlan) {\n          return `Great! You've selected our ${plan.title}. This payment plan option allows you to spread the ${plan.price} cost over several months, making it more manageable. We typically offer 3, 6, or 12-month payment plans. Would you like me to break down the monthly payment options for you?`;\n        }\n        return `Perfect! The ${plan.title} is priced at ${plan.price}${\n          plan.originalPrice\n            ? ` (originally ${plan.originalPrice} - that's a huge savings!)`\n            : \"\"\n        }. This includes our comprehensive credit repair service with ${plan.subtitle.toLowerCase()}. We also offer payment plan options if you'd prefer to spread the cost. Would you like to proceed with this plan or hear about payment options?`;\n      }\n      return \"Our pricing varies depending on the program you choose. Since you're here, I can provide specific details about any plan that interests you. Which program would you like to know more about?\";\n    }\n\n    if (\n      message.includes(\"how long\") ||\n      message.includes(\"time\") ||\n      message.includes(\"results\")\n    ) {\n      if (plan && plan.subtitle.includes(\"7-15 days\")) {\n        return `Excellent choice! Our VIP Fast Track Program is our premium service that delivers results in as little as 7-15 days. This accelerated timeline is possible because we prioritize your case and work around the clock to dispute inaccuracies and optimize your credit profile. Most clients see significant improvements within the first two weeks!`;\n      } else if (plan && plan.subtitle.includes(\"30-45 days\")) {\n        return `Great question! Our Super Sale program typically shows results in 30-45 days. While this takes a bit longer than our VIP program, it's still much faster than trying to repair credit on your own, and you get the same proven methods at a fantastic price point.`;\n      }\n      return \"Our programs are designed for different timelines based on your needs and budget. Our VIP Fast Track shows results in 7-15 days, while our Super Sale program works within 30-45 days. Both use the same proven methods!\";\n    }\n\n    if (\n      message.includes(\"start\") ||\n      message.includes(\"begin\") ||\n      message.includes(\"proceed\")\n    ) {\n      if (plan) {\n        return `Fantastic! I'm excited to get you started with the ${plan.title}. Here's what happens next: 1) We'll process your enrollment, 2) Conduct a comprehensive credit analysis within 24 hours, 3) Create your personalized dispute strategy, and 4) Begin working on your credit immediately. Are you ready to move forward with enrollment?`;\n      }\n      return \"I'm excited to help you get started! Once you select your preferred program, we can begin the enrollment process immediately. Which program interests you most?\";\n    }\n\n    if (message.includes(\"difference\") || message.includes(\"compare\")) {\n      return \"Great question! The main differences are timeline and price: Our VIP Fast Track Program delivers results in 7-15 days for $897, while our Super Sale program works within 30-45 days for $297. Both use the same proven methods and include full credit analysis, dispute letters, and ongoing support. The VIP program just gets prioritized processing for faster results.\";\n    }\n\n    return `Thank you for your interest in ${\n      plan ? `our ${plan.title}` : \"our credit repair services\"\n    }! I'm here to answer any questions about pricing, timelines, our process, or help you get started. What would you like to know more about?`;\n  };\n\n  const handleKeyDown = (e: React.KeyboardEvent) => {\n    if (e.key === \"Enter\" && !e.shiftKey) {\n      e.preventDefault();\n      handleSendMessage();\n    }\n  };\n\n  if (!isAuthenticated) {\n    return <div>Loading...</div>;\n  }\n\n  return (\n    <div className=\"min-h-screen bg-gradient-to-br from-black via-gray-900 to-gray-800\">\n      {/* Navigation */}\n      <nav className=\"bg-white/5 backdrop-blur-md border-b border-white/10 p-3 md:p-4\">\n        <div className=\"max-w-7xl mx-auto flex justify-between items-center\">\n          <div className=\"flex items-center space-x-2 sm:space-x-4\">\n            <Link href=\"/plans\">\n              <Button\n                variant=\"outline\"\n                size=\"sm\"\n                className=\"text-white border-white/20 hover:bg-white/10 bg-transparent text-xs sm:text-sm p-2\"\n              >\n                <ArrowLeft className=\"h-4 w-4\" />\n                <span className=\"hidden sm:inline ml-2\">Back to Plans</span>\n              </Button>\n            </Link>\n            <h1 className=\"text-base sm:text-lg font-bold text-white\">Chat with Agent</h1>\n          </div>\n          {/* Connection Status */}\n          <div className=\"flex items-center space-x-2\">\n            {isConnected ? (\n              <Wifi className=\"h-4 w-4 text-green-400\" />\n            ) : (\n              <WifiOff className=\"h-4 w-4 text-red-400\" />\n            )}\n            <span className=\"text-xs text-gray-300 hidden sm:inline\">\n              {isConnected ? 'Connected' : 'Disconnected'}\n            </span>\n          </div>\n        </div>\n      </nav>\n      <div className=\"flex flex-col h-[calc(100vh-80px)] max-w-4xl mx-auto\">\n        {/* Selected Plan Info - Collapsible on Mobile */}\n        {selectedPlan && (\n          <div className=\"lg:hidden\">\n            <div className=\"mx-3 mb-2\">\n              <button\n                onClick={() => setShowPlanDetails(!showPlanDetails)}\n                className=\"w-full bg-white/5 backdrop-blur-md border border-white/10 text-white p-3 rounded-lg flex items-center justify-between\"\n              >\n                <div className=\"flex items-center space-x-3\">\n                  <div>\n                    <span className=\"font-semibold text-sm\">{selectedPlan.title}</span>\n                    <span className=\"text-white/80 ml-2 text-sm font-bold\">{selectedPlan.price}</span>\n                  </div>\n                </div>\n                {showPlanDetails ? (\n                  <ChevronUp className=\"h-4 w-4\" />\n                ) : (\n                  <ChevronDown className=\"h-4 w-4\" />\n                )}\n              </button>\n              {showPlanDetails && (\n                <div className=\"mt-2 bg-white/5 backdrop-blur-md border border-white/10 text-white p-4 rounded-lg\">\n                  <h3 className=\"font-bold mb-2 text-base\">\n                    {selectedPlan.title}\n                  </h3>\n                  <p className=\"text-gray-300 text-sm mb-3\">\n                    {selectedPlan.subtitle}\n                  </p>\n                  {selectedPlan.price && (\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-xl font-bold text-white\">\n                        {selectedPlan.price}\n                      </span>\n                      {selectedPlan.originalPrice && (\n                        <span className=\"text-sm text-gray-400 line-through\">\n                          {selectedPlan.originalPrice}\n                        </span>\n                      )}\n                    </div>\n                  )}\n                </div>\n              )}\n            </div>\n          </div>\n        )}\n        \n        <div className=\"flex-1 flex lg:grid lg:grid-cols-3 lg:gap-6 p-3 lg:p-6\">\n          {/* Selected Plan Info - Desktop */}\n          {selectedPlan && (\n            <div className=\"hidden lg:block lg:col-span-1\">\n              <Card className=\"bg-white/5 backdrop-blur-md border border-white/10 text-white\">\n                <CardHeader>\n                  <CardTitle className=\"text-lg\">\n                    Selected Plan\n                  </CardTitle>\n                </CardHeader>\n                <CardContent>\n                  <h3 className=\"font-bold mb-2 text-base\">\n                    {selectedPlan.title}\n                  </h3>\n                  <p className=\"text-gray-300 text-sm mb-2\">\n                    {selectedPlan.subtitle}\n                  </p>\n                  {selectedPlan.price && (\n                    <div className=\"flex items-center space-x-2\">\n                      <span className=\"text-xl font-bold text-white\">\n                        {selectedPlan.price}\n                      </span>\n                      {selectedPlan.originalPrice && (\n                        <span className=\"text-sm text-gray-400 line-through\">\n                          {selectedPlan.originalPrice}\n                        </span>\n                      )}\n                    </div>\n                  )}\n                </CardContent>\n              </Card>\n            </div>\n          )}\n          {/* Chat Interface */}\n          <div\n            className={`flex-1 flex flex-col ${\n              selectedPlan ? \"lg:col-span-2\" : \"lg:col-span-3\"\n            }`}\n          >\n            <Card className=\"bg-white/5 backdrop-blur-md border border-white/10 text-white flex-1 flex flex-col\">\n              <CardHeader className=\"pb-3 px-4 py-3\">\n                <CardTitle className=\"flex items-center justify-between text-base sm:text-lg\">\n                  <div className=\"flex items-center\">\n                    <Bot className=\"mr-2 h-4 w-4 sm:h-5 sm:w-5\" />\n                    <span>Credit Repair Agent</span>\n                    {agentOnline && (\n                      <span className=\"ml-2 inline-flex items-center px-2 py-1 rounded-full text-xs bg-green-500/20 text-green-400\">\n                        <div className=\"w-2 h-2 bg-green-400 rounded-full mr-1 animate-pulse\"></div>\n                        Online\n                      </span>\n                    )}\n                  </div>\n                </CardTitle>\n              </CardHeader>\n              {/* Flexible height container for chat */}\n              <div className=\"flex-1 flex flex-col min-h-0\">\n                {/* Messages area - takes up remaining space */}\n                <div className=\"flex-1 px-3 sm:px-6 overflow-hidden\">\n                  <div\n                    ref={messagesContainerRef}\n                    className=\"h-full overflow-y-auto space-y-2 sm:space-y-3 pr-1 sm:pr-2 pb-2\"\n                    style={{\n                      scrollbarWidth: \"thin\",\n                      scrollbarColor: \"rgba(255, 255, 255, 0.3) transparent\",\n                    }}\n                  >\n                    {messages.map((message, index) => (\n                      <div\n                        key={message._id || index}\n                        className={`flex mb-3 ${\n                          message.sender === \"user\"\n                            ? \"justify-end\"\n                            : \"justify-start\"\n                        }`}\n                      >\n                        <div\n                          className={`max-w-[90%] sm:max-w-[85%] md:max-w-[80%] rounded-2xl shadow-sm ${\n                            message.sender === \"user\"\n                              ? \"bg-gradient-to-r from-blue-500 to-blue-600 text-white ml-8 rounded-br-md\"\n                              : \"bg-white/10 text-white mr-8 rounded-bl-md\"\n                          }`}\n                        >\n                          {message.sender === \"agent\" && (\n                            <div className=\"flex items-center space-x-2 px-3 pt-2 pb-1\">\n                              <Bot className=\"h-4 w-4 text-blue-400 flex-shrink-0\" />\n                              <span className=\"text-xs text-blue-400 font-medium\">Agent</span>\n                            </div>\n                          )}\n                          <div className={`px-3 ${message.sender === \"agent\" ? \"pb-3\" : \"py-3\"}`}>\n                            <p className=\"text-sm sm:text-base break-words leading-relaxed\">\n                              {message.text}\n                            </p>\n                            <p className={`text-xs mt-2 ${\n                              message.sender === \"user\" ? \"text-blue-100\" : \"text-gray-400\"\n                            }`}>\n                              {message.timestamp.toLocaleTimeString([], {hour: '2-digit', minute:'2-digit'})}\n                            </p>\n                          </div>\n                        </div>\n                      </div>\n                    ))}\n                    {(isTyping || agentTyping) && (\n                      <div className=\"flex justify-start mb-3\">\n                        <div className=\"bg-white/10 text-white rounded-2xl rounded-bl-md mr-8 px-3 py-3\">\n                          <div className=\"flex items-center space-x-2\">\n                            <Bot className=\"h-4 w-4 text-blue-400\" />\n                            <span className=\"text-xs text-blue-400 font-medium\">Agent is typing</span>\n                            <div className=\"flex space-x-1 ml-2\">\n                              <div className=\"w-2 h-2 bg-blue-400 rounded-full animate-bounce\"></div>\n                              <div\n                                className=\"w-2 h-2 bg-blue-400 rounded-full animate-bounce\"\n                                style={{ animationDelay: \"0.1s\" }}\n                              ></div>\n                              <div\n                                className=\"w-2 h-2 bg-blue-400 rounded-full animate-bounce\"\n                                style={{ animationDelay: \"0.2s\" }}\n                              ></div>\n                            </div>\n                          </div>\n                        </div>\n                      </div>\n                    )}\n                    <div ref={chatEndRef} />\n                  </div>\n                </div>\n                {/* Fixed input area at bottom */}\n                <div className=\"border-t border-white/10 bg-white/5 p-3 sm:p-4\">\n                  <div className=\"flex items-end space-x-2\">\n                    <div className=\"flex-1\">\n                      <Input\n                        value={newMessage}\n                        onChange={handleInputChange}\n                        onKeyDown={handleKeyDown}\n                        placeholder=\"Type your message...\"\n                        className=\"bg-white/10 border-white/20 text-white placeholder:text-gray-400 text-sm rounded-full px-4 py-3 focus:ring-2 focus:ring-blue-500 focus:border-transparent\"\n                      />\n                    </div>\n                    <Button\n                      onClick={handleSendMessage}\n                      className=\"bg-gradient-to-r from-blue-500 to-blue-600 hover:from-blue-600 hover:to-blue-700 text-white rounded-full p-3 min-w-[48px] h-12 flex items-center justify-center\"\n                      disabled={!newMessage.trim()}\n                    >\n                      <Send className=\"h-5 w-5\" />\n                    </Button>\n                  </div>\n                  {(isConnected && agentOnline) && (\n                    <p className=\"text-xs text-gray-400 mt-2 text-center\">\n                      Agent is online â€¢ Messages are delivered instantly\n                    </p>\n                  )}\n                </div>\n              </div>\n            </Card>\n          </div>\n        </div>\n      </div>\n    </div>\n  );\n}\n"],"names":[],"mappings":"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","debugId":null}}]
}